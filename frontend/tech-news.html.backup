<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tech News - NeoSharX</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Space Grotesk", sans-serif;
      }

      body {
        background: #ffffff;
        color: #000000;
        min-height: 100vh;
      }

      /* Fixed Navigation */
      #navigation-placeholder {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        z-index: 1000;
        background: white;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }

      /* Color palette - black/gray/white only */
      :root {
        --black: #000000;
        --white: #ffffff;
        --gray-50: #f9fafb;
        --gray-100: #f3f4f6;
        --gray-200: #e5e7eb;
        --gray-300: #d1d5db;
        --gray-400: #9ca3af;
        --gray-500: #6b7280;
        --gray-600: #4b5563;
        --gray-700: #374151;
        --gray-800: #1f2937;
        --gray-900: #111827;
      }

      /* Loading Spinner */
      .loading-spinner {
        border: 4px solid var(--gray-200);
        border-top: 4px solid var(--black);
        border-radius: 50%;
        width: 50px;
        height: 50px;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      /* Header Section - Fixed below navbar */
      .header-section {
        position: fixed;
        top: 64px; /* Adjust based on your navbar height */
        left: 0;
        right: 0;
        background: var(--black);
        color: var(--white);
        padding: 2rem 0;
        z-index: 900;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      }

      .header-content {
        max-width: 1400px;
        margin: 0 auto;
        padding: 0 2rem;
      }

      .header-title {
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
      }

      .header-subtitle {
        font-size: 1.125rem;
        color: var(--gray-300);
      }

      /* Main content offset for fixed header */
      .content-wrapper {
        margin-top: 200px; /* navbar height + header height */
        padding-bottom: 4rem;
      }

      /* Featured Screens Slider */
      .featured-screens-container {
        position: relative;
        width: 100%;
        overflow: hidden;
        background: var(--gray-50);
        border-radius: 1rem;
        padding: 1.5rem;
        margin-bottom: 3rem;
        border: 1px solid var(--gray-200);
      }

      .featured-slider {
        position: relative;
        width: 100%;
        overflow: hidden;
      }

      .featured-slide {
        display: none;
        grid-template-columns: 1fr 1fr;
        gap: 2rem;
        align-items: center;
        animation: fadeIn 0.5s ease-in;
      }

      .featured-slide.active {
        display: grid;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      .featured-image {
        width: 100%;
        height: 400px;
        object-fit: cover;
        border-radius: 0.75rem;
        border: 1px solid var(--gray-200);
      }

      .featured-content {
        padding: 1rem;
      }

      .slider-dots {
        display: flex;
        justify-content: center;
        gap: 0.75rem;
        margin-top: 2rem;
      }

      .slider-dot {
        width: 10px;
        height: 10px;
        border-radius: 50%;
        background: var(--gray-300);
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .slider-dot.active {
        background: var(--black);
        width: 32px;
        border-radius: 8px;
      }

      /* Category Badge */
      .category-badge {
        display: inline-block;
        padding: 0.375rem 0.875rem;
        background: var(--black);
        color: var(--white);
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        border-radius: 0.375rem;
        margin-bottom: 1rem;
      }

      .breaking-badge {
        display: inline-block;
        padding: 0.375rem 0.875rem;
        background: var(--gray-900);
        color: var(--white);
        font-size: 0.75rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        border-radius: 0.375rem;
        margin-left: 0.5rem;
        animation: pulse 2s ease-in-out infinite;
      }

      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.7;
        }
      }

      /* Cards Grid */
      .articles-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
        gap: 2rem;
        margin-top: 2rem;
      }

      .article-card {
        background: var(--white);
        border: 1px solid var(--gray-200);
        border-radius: 1rem;
        overflow: hidden;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
      }

      .article-card:hover {
        transform: translateY(-6px);
        box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
        border-color: var(--gray-400);
      }

      .article-image {
        width: 100%;
        height: 240px;
        object-fit: cover;
        background: var(--gray-100);
      }

      .article-content {
        padding: 1.5rem;
      }

      .article-title {
        font-size: 1.25rem;
        font-weight: 700;
        color: var(--black);
        margin-bottom: 0.75rem;
        line-height: 1.4;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
      }

      .article-excerpt {
        font-size: 0.9375rem;
        color: var(--gray-600);
        line-height: 1.6;
        margin-bottom: 1rem;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
      }

      .article-meta {
        display: flex;
        align-items: center;
        gap: 1rem;
        font-size: 0.875rem;
        color: var(--gray-500);
        margin-top: 1rem;
        padding-top: 1rem;
        border-top: 1px solid var(--gray-200);
      }

      /* Filters */
      .filters-container {
        display: flex;
        gap: 1rem;
        margin-bottom: 2rem;
        flex-wrap: wrap;
      }

      .filter-select {
        padding: 0.75rem 1.25rem;
        border: 1px solid var(--gray-300);
        border-radius: 0.5rem;
        background: var(--white);
        color: var(--black);
        font-size: 0.9375rem;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
        font-family: "Space Grotesk", sans-serif;
      }

      .filter-select:hover {
        border-color: var(--black);
      }

      .filter-select:focus {
        outline: none;
        border-color: var(--black);
        box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.1);
      }

      /* Responsive */
      @media (max-width: 768px) {
        .header-section {
          top: 56px;
          padding: 1.5rem 0;
        }

        .header-title {
          font-size: 2rem;
        }

        .header-subtitle {
          font-size: 1rem;
        }

        .content-wrapper {
          margin-top: 170px;
        }

        .featured-slide {
          grid-template-columns: 1fr;
        }

        .featured-image {
          height: 280px;
        }

        .articles-grid {
          grid-template-columns: 1fr;
          gap: 1.5rem;
        }

        .filters-container {
          flex-direction: column;
        }

        .filter-select {
          width: 100%;
        }
      }

      /* Empty State */
      .empty-state {
        text-align: center;
        padding: 4rem 2rem;
        color: var(--gray-500);
      }
    </style>
  </head>
  <body>
    <!-- Fixed Navigation -->
    <div id="navigation-placeholder"></div>

    <!-- Fixed Header Section -->
    <div class="header-section">
      <div class="header-content">
        <h1 class="header-title">Tech News</h1>
        <p class="header-subtitle">
          Stay updated with the latest technology news, innovations, and
          breakthroughs
        </p>
      </div>
    </div>

    <!-- Main Content with offset -->
    <div class="content-wrapper">
      <div style="max-width: 1400px; margin: 0 auto; padding: 0 2rem">
        <!-- Loading State -->
        <div
          id="loadingState"
          style="
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 400px;
          "
        >
          <div class="loading-spinner"></div>
        </div>

        <!-- Error State -->
        <div
          id="errorState"
          style="display: none; text-align: center; padding: 4rem 2rem"
        >
          <div style="font-size: 3rem; margin-bottom: 1rem">⚠️</div>
          <h3
            style="
              font-size: 1.5rem;
              font-weight: 600;
              color: var(--gray-900);
              margin-bottom: 0.5rem;
            "
          >
            Unable to load articles
          </h3>
          <p style="color: var(--gray-600)">
            Please check your connection and try again
          </p>
        </div>

        <!-- Content Container -->
        <div id="contentContainer" style="display: none">
          <!-- Featured Screens Slider -->
          <div
            id="featuredSection"
            class="featured-screens-container"
            style="display: none"
          >
            <div class="featured-slider" id="featuredSlider">
              <!-- Featured slides will be inserted here -->
            </div>
            <div class="slider-dots" id="sliderDots">
              <!-- Dots will be inserted here -->
            </div>
          </div>

          <!-- Filters -->
          <div class="filters-container">
            <select id="categoryFilter" class="filter-select">
              <option value="all">All Categories</option>
              <option value="ai_ml">AI & Machine Learning</option>
              <option value="blockchain">Blockchain & Crypto</option>
              <option value="cybersecurity">Cybersecurity</option>
              <option value="funding">Funding & Investment</option>
              <option value="product_launch">Product Launch</option>
            </select>

            <select id="sortFilter" class="filter-select">
              <option value="latest">Latest First</option>
              <option value="popular">Most Popular</option>
              <option value="trending">Trending</option>
            </select>
          </div>

          <!-- Articles Grid -->
          <div id="articlesGrid" class="articles-grid">
            <!-- Article cards will be inserted here -->
          </div>

          <!-- Empty State -->
          <div id="emptyState" class="empty-state" style="display: none">
            <div style="font-size: 3rem; margin-bottom: 1rem">📰</div>
            <h3
              style="
                font-size: 1.5rem;
                font-weight: 600;
                color: var(--gray-700);
                margin-bottom: 0.5rem;
              "
            >
              No articles found
            </h3>
            <p style="color: var(--gray-500)">
              Check back soon for new tech content
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <div id="footer-placeholder"></div>

    <script>
      // State
      let allArticles = [];
      let featuredArticles = [];
      let currentSlide = 0;
      let slideInterval;

      // Load navigation and footer
      async function loadComponents() {
        try {
          // Load navigation
          const navResponse = await fetch("navigation.html");
          const navHtml = await navResponse.text();
          document.getElementById("navigation-placeholder").innerHTML = navHtml;

          // Load footer
          const footerResponse = await fetch("footer.html");
          const footerHtml = await footerResponse.text();
          document.getElementById("footer-placeholder").innerHTML = footerHtml;
        } catch (error) {
          console.error("Error loading components:", error);
        }
      }

      // Fetch articles from API
      async function fetchArticles() {
        try {
          const response = await fetch("http://127.0.0.1:8000/tech-news/");
          const data = await response.json();

          allArticles = data.articles || [];

          // Filter featured articles
          featuredArticles = allArticles.filter(
            (article) =>
              article.is_featured &&
              article.featured_screen &&
              article.featured_screen.url
          );

          // Hide loading, show content
          document.getElementById("loadingState").style.display = "none";
          document.getElementById("contentContainer").style.display = "block";

          // Render content
          if (featuredArticles.length > 0) {
            renderFeaturedSlider();
            startAutoSlide();
          }

          renderArticles(allArticles);
        } catch (error) {
          console.error("Error fetching articles:", error);
          document.getElementById("loadingState").style.display = "none";
          document.getElementById("errorState").style.display = "block";
        }
      }

      // Render featured slider
      function renderFeaturedSlider() {
        const sliderContainer = document.getElementById("featuredSlider");
        const dotsContainer = document.getElementById("sliderDots");

        if (featuredArticles.length === 0) return;

        document.getElementById("featuredSection").style.display = "block";

        // Create slides
        sliderContainer.innerHTML = featuredArticles
          .map(
            (article, index) => `
                <div class="featured-slide ${
                  index === 0 ? "active" : ""
                }" data-slide="${index}">
                    <div>
                        <img 
                            src="${
                              article.featured_screen.url ||
                              article.featured_image ||
                              "https://via.placeholder.com/800x450?text=Tech+News"
                            }" 
                            alt="${article.title}"
                            class="featured-image"
                            onerror="this.src='https://via.placeholder.com/800x450?text=Tech+News'"
                        >
                    </div>
                    <div class="featured-content">
                        <div>
                            <span class="category-badge">${
                              article.category_display ||
                              article.category ||
                              "Tech News"
                            }</span>
                            ${
                              article.is_breaking
                                ? '<span class="breaking-badge">🔴 BREAKING</span>'
                                : ""
                            }
                        </div>
                        <h2 style="font-size: 2rem; font-weight: 700; color: var(--black); margin: 1.5rem 0 1rem; line-height: 1.3;">
                            ${article.title}
                        </h2>
                        ${
                          article.subtitle
                            ? `<h3 style="font-size: 1.125rem; color: var(--gray-600); margin-bottom: 1rem; line-height: 1.5;">${article.subtitle}</h3>`
                            : ""
                        }
                        <p style="font-size: 1rem; color: var(--gray-700); line-height: 1.7; margin-bottom: 1.5rem;">
                            ${article.excerpt || article.summary || ""}
                        </p>
                        <div style="display: flex; align-items: center; gap: 1.5rem; color: var(--gray-500); font-size: 0.875rem; margin-bottom: 2rem;">
                            <span>📅 ${formatDate(article.published_at)}</span>
                            <span>⏱️ ${
                              article.read_time_minutes || 5
                            } min read</span>
                            <span>👁️ ${formatNumber(
                              article.views_count || 0
                            )} views</span>
                        </div>
                        <a 
                            href="tech-detail.html?slug=${article.slug}" 
                            style="display: inline-block; padding: 14px 32px; background: var(--black); color: var(--white); font-weight: 600; border-radius: 0.5rem; text-decoration: none; transition: all 0.2s ease;"
                            onmouseover="this.style.background='var(--gray-800)'; this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 16px rgba(0, 0, 0, 0.2)';"
                            onmouseout="this.style.background='var(--black)'; this.style.transform='translateY(0)'; this.style.boxShadow='none';"
                        >
                            Read Full Article →
                        </a>
                    </div>
                </div>
            `
          )
          .join("");

        // Create dots
        dotsContainer.innerHTML = featuredArticles
          .map(
            (_, index) => `
                <div class="slider-dot ${
                  index === 0 ? "active" : ""
                }" onclick="goToSlide(${index})"></div>
            `
          )
          .join("");
      }

      // Go to specific slide
      function goToSlide(slideIndex) {
        currentSlide = slideIndex;

        // Update slides
        const slides = document.querySelectorAll(".featured-slide");
        slides.forEach((slide, index) => {
          slide.classList.toggle("active", index === slideIndex);
        });

        // Update dots
        const dots = document.querySelectorAll(".slider-dot");
        dots.forEach((dot, index) => {
          dot.classList.toggle("active", index === slideIndex);
        });
      }

      // Auto slide
      function startAutoSlide() {
        if (featuredArticles.length <= 1) return;

        slideInterval = setInterval(() => {
          currentSlide = (currentSlide + 1) % featuredArticles.length;
          goToSlide(currentSlide);
        }, 17000); // 17 seconds
      }

      // Render articles grid
      function renderArticles(articles) {
        const grid = document.getElementById("articlesGrid");
        const emptyState = document.getElementById("emptyState");

        if (articles.length === 0) {
          grid.style.display = "none";
          emptyState.style.display = "block";
          return;
        }

        grid.style.display = "grid";
        emptyState.style.display = "none";

        grid.innerHTML = articles
          .map(
            (article) => `
                <div class="article-card" onclick="window.location.href='tech-detail.html?slug=${
                  article.slug
                }'">
                    <img 
                        src="${
                          article.featured_image ||
                          article.thumbnail_image ||
                          "https://via.placeholder.com/400x240?text=Tech+News"
                        }" 
                        alt="${article.title}"
                        class="article-image"
                        onerror="this.src='https://via.placeholder.com/400x240?text=Tech+News'"
                    >
                    <div class="article-content">
                        <div>
                            <span class="category-badge">${
                              article.category_display ||
                              article.category ||
                              "Tech News"
                            }</span>
                            ${
                              article.is_breaking
                                ? '<span class="breaking-badge">🔴 BREAKING</span>'
                                : ""
                            }
                        </div>
                        <h3 class="article-title">${article.title}</h3>
                        <p class="article-excerpt">${
                          article.excerpt || article.summary || ""
                        }</p>
                        <div class="article-meta">
                            <span>📅 ${formatDate(article.published_at)}</span>
                            <span>⏱️ ${
                              article.read_time_minutes || 5
                            } min</span>
                            <span>👁️ ${formatNumber(
                              article.views_count || 0
                            )}</span>
                        </div>
                    </div>
                </div>
            `
          )
          .join("");
      }

      // Filter articles
      function filterArticles() {
        const category = document.getElementById("categoryFilter").value;
        const sort = document.getElementById("sortFilter").value;

        let filtered = [...allArticles];

        // Filter by category
        if (category !== "all") {
          filtered = filtered.filter(
            (article) => article.category === category
          );
        }

        // Sort
        if (sort === "popular") {
          filtered.sort((a, b) => (b.views_count || 0) - (a.views_count || 0));
        } else if (sort === "trending") {
          filtered.sort((a, b) => (b.likes_count || 0) - (a.likes_count || 0));
        } else {
          // Latest first (default)
          filtered.sort(
            (a, b) => new Date(b.published_at) - new Date(a.published_at)
          );
        }

        renderArticles(filtered);
      }

      // Format date
      function formatDate(dateString) {
        const date = new Date(dateString);
        const options = { year: "numeric", month: "short", day: "numeric" };
        return date.toLocaleDateString("en-US", options);
      }

      // Format number
      function formatNumber(num) {
        if (num >= 1000000) return (num / 1000000).toFixed(1) + "M";
        if (num >= 1000) return (num / 1000).toFixed(1) + "K";
        return num.toString();
      }

      // Event listeners
      document.addEventListener("DOMContentLoaded", () => {
        loadComponents();
        fetchArticles();

        // Filter listeners
        document
          .getElementById("categoryFilter")
          .addEventListener("change", filterArticles);
        document
          .getElementById("sortFilter")
          .addEventListener("change", filterArticles);
      });
    </script>
  </body>
</html>
