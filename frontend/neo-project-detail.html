<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neo Project - NeoSharX</title>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: { primary: "#067ff9" },
            fontFamily: { display: ["Space Grotesk"] }
          }
        }
      };
    </script>
    <style>
        .prose { max-width: none; line-height: 1.8; }
        .prose p { margin-bottom: 1.25em; }
        .prose ul, .prose ol { margin: 1.25em 0; padding-left: 1.5em; }
        .prose li { margin-bottom: 0.5em; }
        .badge { transition: all 0.3s ease; }
        .badge:hover { transform: scale(1.05); }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 font-display">
    <!-- Shared Navigation -->
    <div id="nav-container"></div>

    <div id="loading" class="flex items-center justify-center min-h-screen">
        <div class="text-center">
            <div class="animate-spin rounded-full h-20 w-20 border-b-4 border-primary mx-auto"></div>
            <p class="mt-6 text-gray-600 dark:text-gray-400 text-lg font-semibold">Loading project details...</p>
        </div>
    </div>

    <div id="error" class="hidden flex items-center justify-center min-h-screen">
        <div class="text-center max-w-md mx-auto px-6">
            <i class="fas fa-exclamation-triangle text-7xl text-red-500 mb-6"></i>
            <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-4">Project Not Found</h2>
            <p class="text-gray-600 dark:text-gray-400 mb-6">The project you are looking for does not exist or has been removed.</p>
            <a href="neo-projects.html" class="inline-flex items-center gap-2 bg-primary text-white px-6 py-3 rounded-lg font-bold hover:bg-primary/90 transition-colors">
                <i class="fas fa-arrow-left"></i>
                Back to Projects
            </a>
        </div>
    </div>

    <article id="content" class="hidden">
        <div class="relative h-screen max-h-[600px] bg-cover bg-center" id="hero-image">
            <div class="absolute inset-0 bg-gradient-to-t from-black via-black/60 to-transparent"></div>
            <div class="absolute inset-0 flex items-end">
                <div class="w-full max-w-7xl mx-auto px-6 pb-12">
                    <div class="flex items-center gap-3 mb-4 flex-wrap">
                        <span id="category-badge" class="px-4 py-2 rounded-full text-sm font-bold"></span>
                        <span id="status-badge" class="px-4 py-2 rounded-full text-sm font-bold"></span>
                        <span id="license-badge" class="px-4 py-2 rounded-full text-sm font-bold bg-gray-700 text-white"></span>
                        <span id="opensource-badge" class="hidden px-4 py-2 rounded-full text-sm font-bold bg-green-600 text-white">
                            <i class="fas fa-code-branch mr-1"></i>Open Source
                        </span>
                    </div>
                    <h1 id="project-title" class="text-5xl md:text-6xl font-bold text-white mb-4 leading-tight"></h1>
                    <p id="project-description" class="text-xl text-white/90 mb-6 max-w-4xl"></p>
                    <div class="flex items-center gap-8 text-white/90 text-base flex-wrap">
                        <span id="developer" class="flex items-center gap-2">
                            <i class="fas fa-user-circle"></i>
                            <span class="font-medium"></span>
                        </span>
                        <span id="version-badge" class="flex items-center gap-2">
                            <i class="fas fa-code-branch"></i>
                            <span class="font-medium"></span>
                        </span>
                    </div>
                </div>
            </div>
        </div>

        <div class="max-w-7xl mx-auto px-6 py-12">
            <div class="grid lg:grid-cols-3 gap-8">
                <div class="lg:col-span-2 space-y-8">
                    <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8 border border-gray-100 dark:border-gray-700">
                        <h2 class="text-3xl font-bold mb-6 flex items-center gap-3">
                            <i class="fas fa-info-circle text-primary"></i>
                            About This Project
                        </h2>
                        <div id="detailed-description" class="prose dark:prose-invert text-gray-700 dark:text-gray-300 text-lg"></div>
                    </div>

                    <div id="features-section" class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8 border border-gray-100 dark:border-gray-700">
                        <h2 class="text-3xl font-bold mb-6 flex items-center gap-3">
                            <i class="fas fa-star text-yellow-500"></i>
                            Key Features
                        </h2>
                        <ul id="features-list" class="space-y-3"></ul>
                    </div>

                    <div id="tech-stack-section" class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8 border border-gray-100 dark:border-gray-700">
                        <h2 class="text-3xl font-bold mb-6 flex items-center gap-3">
                            <i class="fas fa-code text-primary"></i>
                            Technology Stack
                        </h2>
                        <div id="tech-stack" class="flex flex-wrap gap-3"></div>
                    </div>

                    <div id="screenshots-section" class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8 border border-gray-100 dark:border-gray-700">
                        <h2 class="text-3xl font-bold mb-6 flex items-center gap-3">
                            <i class="fas fa-images text-primary"></i>
                            Screenshots
                        </h2>
                        <div id="screenshots-grid" class="grid md:grid-cols-2 gap-4"></div>
                    </div>

                    <div id="installation-section" class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8 border border-gray-100 dark:border-gray-700">
                        <h2 class="text-3xl font-bold mb-6 flex items-center gap-3">
                            <i class="fas fa-download text-green-600"></i>
                            Installation Instructions
                        </h2>
                        <div id="installation-content" class="prose dark:prose-invert text-gray-700 dark:text-gray-300"></div>
                    </div>

                    <div id="usage-section" class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8 border border-gray-100 dark:border-gray-700">
                        <h2 class="text-3xl font-bold mb-6 flex items-center gap-3">
                            <i class="fas fa-play-circle text-blue-600"></i>
                            Usage Instructions
                        </h2>
                        <div id="usage-content" class="prose dark:prose-invert text-gray-700 dark:text-gray-300"></div>
                    </div>
                </div>

                <div class="space-y-6">
                    <div class="bg-gradient-to-br from-primary to-blue-600 rounded-2xl shadow-xl p-6 text-white">
                        <h3 class="text-2xl font-bold mb-4">Quick Actions</h3>
                        <div class="space-y-3">
                            <a id="github-link" href="#" target="_blank" class="hidden flex items-center gap-3 bg-white/20 hover:bg-white/30 transition-colors rounded-xl p-4">
                                <i class="fab fa-github text-2xl"></i>
                                <div>
                                    <p class="font-bold">View Source</p>
                                    <p class="text-sm opacity-90">GitHub Repository</p>
                                </div>
                            </a>
                            <a id="demo-link" href="#" target="_blank" class="hidden flex items-center gap-3 bg-white/20 hover:bg-white/30 transition-colors rounded-xl p-4">
                                <i class="fas fa-external-link-alt text-2xl"></i>
                                <div>
                                    <p class="font-bold">Live Demo</p>
                                    <p class="text-sm opacity-90">Try it now</p>
                                </div>
                            </a>
                        </div>
                    </div>

                    <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-6 border border-gray-100 dark:border-gray-700">
                        <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
                            <i class="fas fa-chart-bar text-primary"></i>
                            Project Stats
                        </h3>
                        <div class="space-y-4">
                            <div class="flex justify-between items-center p-3 bg-gray-50 dark:bg-gray-900 rounded-lg">
                                <span class="text-gray-600 dark:text-gray-400 flex items-center gap-2">
                                    <i class="fas fa-signal"></i>
                                    Status
                                </span>
                                <span id="status-text" class="font-bold"></span>
                            </div>
                            <div class="flex justify-between items-center p-3 bg-gray-50 dark:bg-gray-900 rounded-lg">
                                <span class="text-gray-600 dark:text-gray-400 flex items-center gap-2">
                                    <i class="fas fa-layer-group"></i>
                                    Difficulty
                                </span>
                                <span id="difficulty-text" class="font-bold"></span>
                            </div>
                            <div class="flex justify-between items-center p-3 bg-gray-50 dark:bg-gray-900 rounded-lg">
                                <span class="text-gray-600 dark:text-gray-400 flex items-center gap-2">
                                    <i class="fas fa-tag"></i>
                                    Version
                                </span>
                                <span id="version-text" class="font-bold"></span>
                            </div>
                            <div class="flex justify-between items-center p-3 bg-gray-50 dark:bg-gray-900 rounded-lg">
                                <span class="text-gray-600 dark:text-gray-400 flex items-center gap-2">
                                    <i class="fas fa-balance-scale"></i>
                                    License
                                </span>
                                <span id="license-text" class="font-bold"></span>
                            </div>
                        </div>
                    </div>

                    <div id="collaborators-section" class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-6 border border-gray-100 dark:border-gray-700">
                        <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
                            <i class="fas fa-users text-primary"></i>
                            Collaborators
                        </h3>
                        <div id="collaborators-list" class="space-y-3"></div>
                    </div>

                    <div id="tags-section" class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-6 border border-gray-100 dark:border-gray-700">
                        <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
                            <i class="fas fa-tags text-primary"></i>
                            Tags
                        </h3>
                        <div id="tags-list" class="flex flex-wrap gap-2"></div>
                    </div>
                </div>
            </div>

            <div id="related-section" class="mt-16">
                <h2 class="text-4xl font-bold mb-8 flex items-center gap-3">
                    <i class="fas fa-layer-group text-primary"></i>
                    Related Projects
                </h2>
                <div id="related-grid" class="grid md:grid-cols-3 gap-6"></div>
            </div>

            <!-- Comments Section -->
            <div class="mt-16 max-w-4xl mx-auto">
                <h2 class="text-4xl font-bold mb-8 flex items-center gap-3">
                    <i class="fas fa-comments text-primary"></i>
                    Comments
                </h2>
                <div id="comments-container"></div>
            </div>

            <div class="mt-12 text-center">
                <a href="neo-projects.html" class="inline-flex items-center gap-3 text-primary hover:text-primary/80 text-lg font-semibold transition-colors">
                    <i class="fas fa-arrow-left"></i>
                    Back to All Projects
                </a>
            </div>
        </div>
    </article>

    <script>
        const API_URL = 'http://localhost:8000/api/auth/neo-projects/';
        let currentProject = null;
        let hasStarred = false;

        async function loadProject() {
            const params = new URLSearchParams(window.location.search);
            const slug = params.get('slug');
            
            if (!slug) {
                window.location.href = 'neo-projects.html';
                return;
            }

            try {
                const response = await fetch(API_URL);
                const data = await response.json();
                const project = data.find(function(p) { return p.slug === slug; });
                
                if (!project) {
                    showError();
                    return;
                }

                currentProject = project;
                displayProject(project);
                loadRelatedProjects(data, project.id);
                
                document.getElementById('loading').classList.add('hidden');
                document.getElementById('content').classList.remove('hidden');
                
                // Initialize comment system after project is loaded
                if (typeof CommentSystem !== 'undefined') {
                    const commentSystem = new CommentSystem(
                        "neo_project",
                        slug,
                        "comments-container",
                        {
                            apiBaseUrl: "http://localhost:8000/api/auth",
                            showLoginPrompt: true,
                            enableReplies: true,
                            enableLikes: true,
                        }
                    );
                }
            } catch (error) {
                console.error('Error:', error);
                showError();
            }
        }

        function showError() {
            document.getElementById('loading').classList.add('hidden');
            document.getElementById('error').classList.remove('hidden');
        }

        function displayProject(p) {
            document.title = p.title + ' - NeoSharX Neo Projects';
            
            document.getElementById('hero-image').style.backgroundImage = 'url(' + (p.featured_image || 'https://images.unsplash.com/photo-1517694712202-14dd9538aa97?w=1200') + ')';
            document.getElementById('project-title').textContent = p.title;
            document.getElementById('project-description').textContent = p.description;
            
            const categoryColors = {
                'ai_ml': 'bg-purple-600 text-white',
                'blockchain': 'bg-yellow-600 text-white',
                'iot': 'bg-green-600 text-white',
                'ar_vr': 'bg-pink-600 text-white',
                'data_science': 'bg-blue-600 text-white'
            };
            const catColor = categoryColors[p.category] || 'bg-gray-600 text-white';
            document.getElementById('category-badge').className = 'px-4 py-2 rounded-full text-sm font-bold badge ' + catColor;
            document.getElementById('category-badge').textContent = formatCategory(p.category);
            
            const statusColors = {
                'completed': 'bg-green-600 text-white',
                'in_development': 'bg-yellow-600 text-white',
                'beta': 'bg-blue-600 text-white',
                'maintained': 'bg-emerald-600 text-white'
            };
            const statusColor = statusColors[p.status] || 'bg-gray-600 text-white';
            document.getElementById('status-badge').className = 'px-4 py-2 rounded-full text-sm font-bold badge ' + statusColor;
            document.getElementById('status-badge').textContent = formatStatus(p.status);
            
            document.getElementById('license-badge').textContent = p.license || 'MIT';
            
            if (p.is_open_source) {
                document.getElementById('opensource-badge').classList.remove('hidden');
            }
            
            document.getElementById('developer').querySelector('span').textContent = p.developer_name || 'NeoSharX Team';
            document.getElementById('version-badge').querySelector('span').textContent = 'v' + (p.version || '1.0.0');
            
            document.getElementById('detailed-description').innerHTML = formatContent(p.detailed_description || p.description);
            
            if (p.features && p.features.length > 0) {
                document.getElementById('features-list').innerHTML = p.features.map(function(f) {
                    return '<li class="flex items-start gap-3 p-4 bg-gray-50 dark:bg-gray-900 rounded-xl border border-gray-200 dark:border-gray-700">' +
                        '<i class="fas fa-check-circle text-primary text-xl mt-1 flex-shrink-0"></i>' +
                        '<span class="text-gray-700 dark:text-gray-300 text-lg">' + f + '</span>' +
                    '</li>';
                }).join('');
            } else {
                document.getElementById('features-section').classList.add('hidden');
            }
            
            if (p.technology_list && p.technology_list.length > 0) {
                document.getElementById('tech-stack').innerHTML = p.technology_list.map(function(tech) {
                    return '<span class="badge px-4 py-2 bg-primary/10 text-primary rounded-xl font-semibold text-base border-2 border-primary/20">' + tech + '</span>';
                }).join('');
            } else {
                document.getElementById('tech-stack-section').classList.add('hidden');
            }
            
            if (p.screenshots && p.screenshots.length > 0) {
                document.getElementById('screenshots-grid').innerHTML = p.screenshots.map(function(img) {
                    return '<div class="group relative overflow-hidden rounded-xl cursor-pointer" onclick="window.open(' + "'" + img + "'" + ', ' + "'_blank'" + ')">' +
                        '<img src="' + img + '" class="w-full h-64 object-cover transition-transform group-hover:scale-110" />' +
                        '<div class="absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center">' +
                            '<i class="fas fa-expand text-white text-3xl"></i>' +
                        '</div>' +
                    '</div>';
                }).join('');
            } else {
                document.getElementById('screenshots-section').classList.add('hidden');
            }
            
            if (p.installation_instructions) {
                document.getElementById('installation-content').innerHTML = formatInstructions(p.installation_instructions);
            } else {
                document.getElementById('installation-section').classList.add('hidden');
            }
            
            if (p.usage_instructions) {
                document.getElementById('usage-content').innerHTML = formatInstructions(p.usage_instructions);
            } else {
                document.getElementById('usage-section').classList.add('hidden');
            }
            
            if (p.github_url) {
                document.getElementById('github-link').href = p.github_url;
                document.getElementById('github-link').classList.remove('hidden');
            }
            
            if (p.demo_url) {
                document.getElementById('demo-link').href = p.demo_url;
                document.getElementById('demo-link').classList.remove('hidden');
            }
            
            document.getElementById('status-text').textContent = formatStatus(p.status);
            document.getElementById('difficulty-text').textContent = formatDifficulty(p.difficulty_level);
            document.getElementById('version-text').textContent = p.version || '1.0.0';
            document.getElementById('license-text').textContent = p.license || 'MIT';
            
            if (p.collaborator_list && p.collaborator_list.length > 0) {
                document.getElementById('collaborators-list').innerHTML = p.collaborator_list.map(function(collab, idx) {
                    return '<div class="flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-900 rounded-lg">' +
                        '<img src="https://i.pravatar.cc/150?img=' + (idx + 10) + '" class="w-12 h-12 rounded-full border-2 border-primary" />' +
                        '<div>' +
                            '<p class="font-bold text-gray-900 dark:text-white">' + collab + '</p>' +
                            '<p class="text-sm text-gray-600 dark:text-gray-400">Contributor</p>' +
                        '</div>' +
                    '</div>';
                }).join('');
            } else {
                document.getElementById('collaborators-section').classList.add('hidden');
            }
            
            if (p.tag_list && p.tag_list.length > 0) {
                document.getElementById('tags-list').innerHTML = p.tag_list.map(function(tag) {
                    return '<span class="badge px-3 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg text-sm font-medium">' + tag + '</span>';
                }).join('');
            } else {
                document.getElementById('tags-section').classList.add('hidden');
            }
        }

        function formatCategory(cat) {
            const names = {
                'ai_ml': 'AI & Machine Learning',
                'blockchain': 'Blockchain',
                'iot': 'Internet of Things',
                'ar_vr': 'AR/VR',
                'data_science': 'Data Science'
            };
            return names[cat] || cat;
        }

        function formatStatus(status) {
            return (status || '').replace('_', ' ').split(' ').map(function(w) {
                return w.charAt(0).toUpperCase() + w.slice(1);
            }).join(' ');
        }

        function formatDifficulty(diff) {
            return (diff || 'intermediate').charAt(0).toUpperCase() + (diff || 'intermediate').slice(1);
        }

        function formatNumber(num) {
            if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
            if (num >= 1000) return (num / 1000).toFixed(1) + 'K';
            return num.toString();
        }

        function formatContent(content) {
            if (!content) return '<p class="text-gray-500">No detailed description available.</p>';
            
            var formatted = content.replace(/\n\n/g, '</p><p class="mb-4">');
            formatted = '<p class="mb-4">' + formatted + '</p>';
            formatted = formatted.replace(/\*\*(.*?)\*\*/g, '<strong class="font-bold text-gray-900 dark:text-white">$1</strong>');
            formatted = formatted.replace(/\*(.*?)\*/g, '<em>$1</em>');
            
            return formatted;
        }

        function formatInstructions(text) {
            if (!text) return '<p class="text-gray-500">No instructions available.</p>';
            
            var lines = text.split('\n');
            var formatted = '<ol class="list-decimal list-inside space-y-2">';
            lines.forEach(function(line) {
                if (line.trim()) {
                    formatted += '<li class="text-gray-700 dark:text-gray-300 pl-2">' + line.replace(/^\d+\.\s*/, '') + '</li>';
                }
            });
            formatted += '</ol>';
            
            return formatted;
        }

        function loadRelatedProjects(allProjects, currentId) {
            const related = allProjects.filter(function(p) { 
                return p.id !== currentId && p.category === currentProject.category; 
            }).slice(0, 3);
            
            if (related.length === 0) {
                const anyOther = allProjects.filter(function(p) { return p.id !== currentId; }).slice(0, 3);
                if (anyOther.length > 0) {
                    displayRelated(anyOther);
                } else {
                    document.getElementById('related-section').classList.add('hidden');
                }
            } else {
                displayRelated(related);
            }
        }

        function displayRelated(projects) {
            document.getElementById('related-grid').innerHTML = projects.map(function(p) {
                return '<a href="neo-project-detail.html?slug=' + p.slug + '" class="group block bg-white dark:bg-gray-800 rounded-2xl overflow-hidden shadow-lg hover:shadow-2xl transition-all hover:-translate-y-2 border border-gray-100 dark:border-gray-700">' +
                    '<div class="aspect-video bg-cover bg-center" style="background-image: url(' + (p.featured_image || 'https://via.placeholder.com/400x300') + ')"></div>' +
                    '<div class="p-5">' +
                        '<span class="text-xs px-3 py-1 rounded-full bg-primary/10 text-primary font-semibold">' + formatCategory(p.category) + '</span>' +
                        '<h3 class="text-xl font-bold mt-3 mb-2 group-hover:text-primary transition-colors line-clamp-2">' + p.title + '</h3>' +
                        '<p class="text-sm text-gray-600 dark:text-gray-400 line-clamp-2">' + p.description + '</p>' +
                    '</div>' +
                '</a>';
            }).join('');
        }

        // Load shared navigation
        fetch("navigation.html")
            .then((res) => res.text())
            .then((html) => {
                document.getElementById("nav-container").innerHTML = html;
            })
            .catch((err) => console.error("Navigation load error:", err));

        document.addEventListener('DOMContentLoaded', loadProject);
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="comment-system.js"></script>
</body>
</html>
