<!DOCTYPE html>
<html lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>NeoSharX - Startup Stories</title>
<link crossorigin="" href="https://fonts.gstatic.com/" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Newsreader:wght@400;500;700;800&amp;display=swap" rel="stylesheet"/>
<link href="./dist/output.css" rel="stylesheet" />
<script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#067ff9",
                        "background-light": "#f5f7f8",
                        "background-dark": "#0f1923",
                        "content-light": "#111418",
                        "content-dark": "#f5f7f8",
                        "subtle-light": "#5f758c",
                        "subtle-dark": "#a0aec0"
                    },
                    fontFamily: {
                        "display": ["Newsreader"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.5rem",
                        "lg": "0.75rem",
                        "xl": "1rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>
<style>
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(6, 127, 249, 0.3);
            border-radius: 50%;
            border-top-color: #067ff9;
            animation: spin 1s ease-in-out infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        .line-clamp-3 {
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
    </style>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
</head>
<body class="bg-background-light dark:bg-background-dark font-display text-content-light dark:text-content-dark" data-page="startup">
<div class="relative flex flex-col min-h-screen w-full">
<!-- Navigation -->
<div id="nav-placeholder"></div>
<main class="flex-grow container mx-auto px-4 sm:px-6 lg:px-8 py-4">
<div class="max-w-4xl mx-auto">
<div class="text-center mb-8">
<h1 class="text-5xl font-extrabold tracking-tighter mb-4">Startup Stories</h1>
<p class="text-lg text-subtle-light dark:text-subtle-dark max-w-2xl mx-auto">Dive into the journeys of founders and their innovative ventures. Discover insights, challenges, and triumphs from the startup ecosystem.</p>
</div>
<div class="flex flex-wrap items-center justify-center gap-4 mb-12">
<select id="industryFilter" class="px-4 py-2 text-sm font-medium bg-background-light dark:bg-background-dark border border-subtle-light/20 dark:border-subtle-dark/20 rounded-full hover:bg-primary/10 transition-colors">
<option value="">All Industries</option>
</select>
<select id="stageFilter" class="px-4 py-2 text-sm font-medium bg-background-light dark:bg-background-dark border border-subtle-light/20 dark:border-subtle-dark/20 rounded-full hover:bg-primary/10 transition-colors">
<option value="">All Stages</option>
</select>
<select id="sortBy" class="px-4 py-2 text-sm font-medium bg-background-light dark:bg-background-dark border border-subtle-light/20 dark:border-subtle-dark/20 rounded-full hover:bg-primary/10 transition-colors">
<option value="recent">Most Recent</option>
<option value="popular">Most Popular</option>
<option value="oldest">Oldest First</option>
</select>
</div>
<div id="featuredStory" class="mb-16">
<div class="flex items-center justify-center py-12">
<div class="loading"></div>
<span class="ml-3 text-subtle-light dark:text-subtle-dark">Loading featured story...</span>
</div>
</div>
</div>
<h2 class="text-3xl font-bold tracking-tight text-center mb-10">More Stories</h2>
<div id="storiesList" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
<div class="flex items-center justify-center col-span-full py-12">
<div class="loading"></div>
<span class="ml-3 text-subtle-light dark:text-subtle-dark">Loading stories...</span>
</div>
</div>
</div>
</main>
<footer class="bg-background-light dark:bg-background-dark border-t border-subtle-light/20 dark:border-subtle-dark/20">
<div class="container mx-auto px-4 sm:px-6 lg:px-8 py-8">
<div class="flex flex-col md:flex-row justify-between items-center gap-6">
<div class="flex items-center gap-2 text-primary">
<svg class="h-6 w-6" fill="none" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
<path d="M4 42.4379C4 42.4379 14.0962 36.0744 24 41.1692C35.0664 46.8624 44 42.2078 44 42.2078L44 7.01134C44 7.01134 35.068 11.6577 24.0031 5.96913C14.0971 0.876274 4 7.27094 4 7.27094L4 42.4379Z" fill="currentColor"></path>
</svg>
<h2 class="text-lg font-bold">NeoSharX</h2>
</div>
<div class="flex flex-wrap items-center justify-center gap-x-6 gap-y-2">
<a class="text-sm text-subtle-light dark:text-subtle-dark hover:text-primary transition-colors" href="#">About</a>
<a class="text-sm text-subtle-light dark:text-subtle-dark hover:text-primary transition-colors" href="#">Contact</a>
<a class="text-sm text-subtle-light dark:text-subtle-dark hover:text-primary transition-colors" href="#">Terms of Service</a>
<a class="text-sm text-subtle-light dark:text-subtle-dark hover:text-primary transition-colors" href="#">Privacy Policy</a>
</div>
<p class="text-sm text-subtle-light dark:text-subtle-dark">© 2023 NeoSharX. All rights reserved.</p>
</div>
</div>
</footer>
</div>

<script>
const API_BASE_URL = 'http://localhost:8000/api/auth';
let allStories = [];
let filters = {};

// Load filters from API
async function loadFilters() {
    try {
        const response = await fetch(`${API_BASE_URL}/stories/filters/`);
        const data = await response.json();
        
        // Populate industry filter
        const industryFilter = document.getElementById('industryFilter');
        data.industries.forEach(([value, label]) => {
            const option = document.createElement('option');
            option.value = value;
            option.textContent = label;
            industryFilter.appendChild(option);
        });

        // Populate stage filter
        const stageFilter = document.getElementById('stageFilter');
        data.stages.forEach(([value, label]) => {
            const option = document.createElement('option');
            option.value = value;
            option.textContent = label;
            stageFilter.appendChild(option);
        });

        filters = data;
    } catch (error) {
        console.error('Error loading filters:', error);
    }
}

// Load featured story
async function loadFeaturedStory() {
    try {
        const response = await fetch(`${API_BASE_URL}/stories/featured/`);
        const story = await response.json();
        
        const featuredStoryHTML = `
            <div class="group overflow-hidden rounded-xl bg-background-light dark:bg-background-dark shadow-lg transition-shadow hover:shadow-2xl cursor-pointer" onclick="window.location.href='story-detail.html?slug=${story.slug}'">
                <div class="grid md:grid-cols-2 gap-8 items-center">
                    <div class="relative">
                        <div class="w-full aspect-video bg-cover bg-center" style="background-image: url('${story.featured_image || 'https://images.unsplash.com/photo-1522071820081-009f0129c71c?w=800'}');"></div>
                        <div class="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent"></div>
                    </div>
                    <div class="p-8">
                        <span class="text-sm font-bold text-primary uppercase tracking-widest">Featured Story</span>
                        <h2 class="text-3xl font-bold tracking-tight mt-2 mb-4">${story.heading}</h2>
                        <p class="text-subtle-light dark:text-subtle-dark mb-6">${story.summary}</p>
                        <a href="story-detail.html?slug=${story.slug}" class="inline-block bg-primary text-white font-bold px-6 py-3 rounded-lg hover:bg-primary/90 transition-colors">Read More</a>
                    </div>
                </div>
            </div>
        `;
        
        document.getElementById('featuredStory').innerHTML = featuredStoryHTML;
    } catch (error) {
        console.error('Error loading featured story:', error);
        document.getElementById('featuredStory').innerHTML = `
            <div class="text-center py-8 text-red-500">
                Failed to load featured story. Please try again later.
            </div>
        `;
    }
}

// Load all stories
async function loadStories(industry = '', stage = '', sort = 'recent') {
    try {
        let url = `${API_BASE_URL}/stories/`;
        const params = new URLSearchParams();
        if (industry) params.append('industry', industry);
        if (stage) params.append('stage', stage);
        if (sort) params.append('sort', sort);
        
        if (params.toString()) {
            url += '?' + params.toString();
        }

        const response = await fetch(url);
        allStories = await response.json();
        
        renderStories(allStories.filter(s => !s.is_featured));
    } catch (error) {
        console.error('Error loading stories:', error);
        document.getElementById('storiesList').innerHTML = `
            <div class="col-span-full text-center py-8 text-red-500">
                Failed to load stories. Please try again later.
            </div>
        `;
    }
}

// Render stories
function renderStories(stories) {
    const storiesList = document.getElementById('storiesList');
    
    if (stories.length === 0) {
        storiesList.innerHTML = `
            <div class="col-span-full text-center py-12 text-subtle-light dark:text-subtle-dark">
                No stories found matching your filters.
            </div>
        `;
        return;
    }

    const storiesHTML = stories.map(story => `
        <div class="group flex flex-col gap-4 bg-background-light dark:bg-background-dark rounded-xl overflow-hidden shadow-md hover:shadow-xl transition-all hover:-translate-y-1 cursor-pointer" onclick="window.location.href='story-detail.html?slug=${story.slug}'">
            <div class="relative">
                <div class="w-full aspect-video bg-cover bg-center" style="background-image: url('${story.featured_image || 'https://images.unsplash.com/photo-1522071820081-009f0129c71c?w=800'}');"></div>
                <div class="absolute top-4 right-4">
                    <span class="bg-primary text-white text-xs font-bold px-3 py-1 rounded-full">
                        ${getStageLabel(story.stage)}
                    </span>
                </div>
            </div>
            <div class="p-5 flex flex-col flex-grow">
                <div class="flex items-center gap-2 mb-2">
                    <span class="text-xs font-semibold text-subtle-light dark:text-subtle-dark uppercase">
                        ${getIndustryLabel(story.industry)}
                    </span>
                </div>
                <h3 class="text-lg font-bold mb-2 line-clamp-2">${story.heading}</h3>
                <p class="text-sm text-subtle-light dark:text-subtle-dark flex-grow line-clamp-3">${story.summary}</p>
                <div class="flex items-center justify-between mt-4">
                    <span class="text-xs font-semibold text-content-light dark:text-content-dark">
                        ${story.company_name}
                    </span>
                    <a href="story-detail.html?slug=${story.slug}" class="text-sm font-bold text-primary hover:underline">
                        Read More →
                    </a>
                </div>
            </div>
        </div>
    `).join('');

    storiesList.innerHTML = storiesHTML;
}

// Helper functions
function getIndustryLabel(value) {
    if (!filters.industries) return value;
    const industry = filters.industries.find(([v]) => v === value);
    return industry ? industry[1] : value;
}

function getStageLabel(value) {
    if (!filters.stages) return value;
    const stage = filters.stages.find(([v]) => v === value);
    return stage ? stage[1] : value;
}

// Event listeners
document.getElementById('industryFilter').addEventListener('change', (e) => {
    loadStories(e.target.value, document.getElementById('stageFilter').value, document.getElementById('sortBy').value);
});

document.getElementById('stageFilter').addEventListener('change', (e) => {
    loadStories(document.getElementById('industryFilter').value, e.target.value, document.getElementById('sortBy').value);
});

document.getElementById('sortBy').addEventListener('change', (e) => {
    loadStories(document.getElementById('industryFilter').value, document.getElementById('stageFilter').value, e.target.value);
});

// Initialize on page load
document.addEventListener('DOMContentLoaded', () => {
    loadFilters();
    loadFeaturedStory();
    loadStories();
});
</script>

<!-- Load Navigation -->
<script src="nav-loader.js"></script>

</body></html>